## winsl - windows sevice launcher for Java programs

Этот проект был вдохновлен проектом [Java Service launcher](http://www.roeschter.de/) (далее JSL), поскольку время от времени у Java-разработчиков возникает потребность в запуске свох приложений в виде сервисов Windows. 
В ОС Linux подобного рода задача решается с помощью старнартного механизма демонов, в Windows же готового решения "из коробки" для Java-приложений нет. 

Главное отличие данного проекта от "источника вдохновения" - способ его реализации:

- в проекте JSL принят подход "запуск JVM сервиса из кода C++" (см, например, [здесь](https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/invocation.html))
- в данном проекте принят подход "запуск сервиса из JVM с помощью JNI" (см, например, [здесь](https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/jniTOC.html))

Т.е. в проекте JSL "движущей силой" является C++ код, который запускает JVM для работы сервиса и управляет ею, в данном проекте, наоборот, JVM запускает и управляет сервисом с помощью кода на C++.

### Детали реализации

Проект winsl собран в виде выполнимого файла winsl.jar. В нем содержится, по крайней мере, три класса, имеющие в своем составе методы **public static void man(String[])**:

- класс chav1961.bt.winsl.Application - класс, управляющий процессом инсталляции сервиса
- класс chav1961.bt.winsl.Service - класс, реализующий сервис как таковой
- класс chav1961.bt.winsl.echoserver.EchoServer - класс-демо, который может быть использован для проверки работы сервиса

Инсталляция сервиса выполняется из командной строки консоли Windows, запущенной в режиме администратора (именно класс chav1961.bt.winsl.Application обрабатывает командную строку). Формат командной строки следующий:

    java -jar winsl.jar <режим> [<опции>]

где:

* <режим> - один из вариантов:
    + **install** - инсталлировать новый сервис на компьютер
    + **update** - обновить настройки установленного сервиса
    + **remove** - удалить существующий сервис с компьютера
    + **reinstall** - переустановить сервис на компьютер
    + **query** - проверить наличие установленного сервиса на компьютере
    + **autoconf** - автоматически обновить некоторые параметры конфигураци
* <опции> - одна или несколько опций:    + **-conf** <URL_файла_конфигурации> - местоположение файла конфигурации. Для всех режимов, кроме **query**, является обязательным параметро
    + **-serviceName** <имя_службы> - имя службы, с которой производится манипуляции. Если указано, то перекрывает имя службы, задаваемой в файле конфигурации. Это удобно, когда на компьютер ставится несколько однотипных служб
    + **-demo** <номер_порта> - устанавливает вместо вашего сервиса встроенную службу эхо-сервера (класс chav1961.bt.winsl.echoserver.EchoServer). При указании в адресной строке любого браузера http:://localhost:<номер_порта> выдаст на экран страницу с параметрами вашего запроса. Если номер порта не задан, по умолчанию будет использован порт **8080**.
Настройка сервиса выполняется с помощью файла конфигурации. В качестве него может выступать любой URL, до которого сможет добраться winsl (файл на диске, http-ссылка и т.д.). Содержимое файла конфгурации должно быть пригодно для чтения java-классом java.util.Properties. Список поддерживаемых параметров файла конфигурации приведен ниже:



|  Параметр          | Назначение   |
| --- | --- |
| ыыы                | sss |


Запуск в работу сервиса происходит с помощью стандартного механизма Windows. Параметр Path to application должен иметь вид:

    java -cp winsl.jar chav1961.bt.winsl.Service <параметры>

В качестве параметров сервису необходимо, как минимум, передать файл конфигурации (**-conf** <URL_файла_конфигурации>). Этот файл не обязательно должен быть тем же самым, который использовался на стадии инсталляции сервиса, но может быть и тем же самым. Содержимое файла конфгурации должно быть пригодно для чтения java-классом java.util.Properties. Список поддерживаемых параметров файла конфигурации приведен ниже:


|  Параметр          | Назначение   |
| --- | --- |
| ыыы                | sss |

В соответствии параметром файла конфигурации, класс chav1961.bt.winsl.Service, с помощью метода Class.forName(...), загрузит описание класса, реализующего ваш сервис, найдет в нем указанный метод с сигнатурой ([Ljava.lang.String)V, и вызовет его на выполнение. Естественно, для того, чтобы метод Class.forName(...) был в состоянии найти ваш сервис, его надо указать в Path to application:

	java -cp winsl.jar;<classpath_to_your_application_jars> chav1961.bt.winsl.Service <параметры>
	
